this.novablocks=this.novablocks||{},this.novablocks.mediaComposition=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=74)}({0:function(e,t){e.exports=window.wp.element},1:function(e,t){e.exports=window.wp.i18n},11:function(e,t,n){"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return i}))},13:function(e,t){e.exports=window.wp.blockEditor},14:function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return i}))},17:function(e,t,n){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,"a",(function(){return i}))},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(17);function o(e,t){if(e){if("string"==typeof e)return Object(i.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(i.a)(e,t):void 0}}},24:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(21);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var i,o,r=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return r}}(e,t)||Object(i.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},26:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(17);var o=n(21);function r(e){return function(e){if(Array.isArray(e))return Object(i.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},3:function(e,t){e.exports=window.wp.components},32:function(e,t){e.exports=window.jQuery},37:function(e){e.exports=JSON.parse('{"images":{"type":"array","default":[],"items":{"type":"object"}},"stylePreset":{"type":"string","default":"the-cloud-atlas"},"sizeContrast":{"type":"number","default":0},"positionShift":{"type":"number","default":0},"elementsDistance":{"type":"number","default":20},"placementVariation":{"type":"number","default":25},"imageRotation":{"type":"number","default":0},"imageResizing":{"type":"string","default":"cropped"},"containerHeight":{"type":"number","default":50},"objectPosition":{"type":"number","default":50},"defaultsGenerated":{"type":"boolean","default":false}}')},4:function(e,t){e.exports=window.novablocks.utils},5:function(e,t){e.exports=window.novablocks.blockEditor},50:function(e,t){e.exports=window.novablocks.shapeModeling},6:function(e,t){e.exports=window.wp.hooks},7:function(e,t){e.exports=window.wp.compose},74:function(e,t,n){"use strict";n.r(t),n.d(t,"BlockControls",(function(){return m})),n.d(t,"MediaCompositionSection",(function(){return C})),n.d(t,"AdvancedGalleryItemMedia",(function(){return M})),n.d(t,"AdvancedGalleryItem",(function(){return P})),n.d(t,"MediaCompositionPlaceholder",(function(){return R})),n.d(t,"MediaCompositionPreview",(function(){return T})),n.d(t,"MediaComposition",(function(){return B})),n.d(t,"GridItemCollection",(function(){return _})),n.d(t,"GridItem",(function(){return j})),n.d(t,"getRandomAttributes",(function(){return w})),n.d(t,"getMediaCompositionCSSProps",(function(){return E})),n.d(t,"safariHeightFix",(function(){return x})),n.d(t,"attributes",(function(){return o}));var i=n(6),o=n(37),r=n(0),a=n(1),l=n(13),c=n(3),s=n(5),u=["image","video"],d=Object(s.withVisibility)("media-composition-block-controls")((function(e){var t=e.onSelectImages,n=e.attributes,i=e.context,o=(null==i?void 0:i.queryId)||!1;if(Number.isFinite(o))return null;var s=((null==n?void 0:n.images)||[]).map((function(e){return e.id}));return Object(r.createElement)(c.ToolbarGroup,{label:Object(a.__)("Media","nova-blocks")},Object(r.createElement)(c.Dropdown,{position:"bottom right",contentClassName:"block-editor-media-replace-flow__options",renderToggle:function(e){var t=e.isOpen,n=e.onToggle;return Object(r.createElement)(c.ToolbarButton,{onClick:n,"aria-expanded":t},Object(a.__)("Change Media","nova-blocks"))},renderContent:function(e){e.onClose;return Object(r.createElement)(c.NavigableMenu,null,Object(r.createElement)(l.MediaUpload,{gallery:!0,allowedTypes:u,multiple:!0,value:s,onSelect:t,render:function(e){var t=e.open;return Object(r.createElement)(c.MenuItem,{onClick:t},Object(a.__)("Edit Gallery","nova-blocks"))}}),Object(r.createElement)(l.MediaUpload,{allowedTypes:u,multiple:!0,value:s,onSelect:t,render:function(e){var t=e.open;return Object(r.createElement)(c.MenuItem,{onClick:t},Object(a.__)("Add Video","nova-blocks"))}}))}}))})),m=function(e){return Object(r.createElement)(l.BlockControls,null,Object(r.createElement)(d,e))},p=n(11),b=n(32),f=n.n(b),g=n(4),v=n(26);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function O(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}var _=function(){function e(t,n){y(this,e);var i=n.placementVariation/25-1;this.gridItems=t.map((function(e,i){var o=4*Math.floor(i/4),r=Math.min(o+4,t.length);return new j(e,i,n,r-o==3)})),this.removeExtra(),1!==i&&2!==i||this.flipX(),2!==i&&3!==i||this.flipY()}return O(e,[{key:"removeExtra",value:function(){var e=this.getExtraLeft(),t=this.getExtraTop(),n=this.getExtraBetween();this.gridItems=this.gridItems.map((function(i,o){var r=Math.floor(o/4);return i.x=i.x-e,i.y=i.y-t-r*n,i}))}},{key:"flipX",value:function(){var e=Math.max.apply(Math,Object(v.a)(this.gridItems.map((function(e){return e.x+e.width}))));this.gridItems=this.gridItems.map((function(t,n){return t.x=e-t.x-t.width+1,t}))}},{key:"flipY",value:function(){var e=Math.max.apply(Math,Object(v.a)(this.gridItems.map((function(e){return e.y+e.height}))));this.gridItems=this.gridItems.map((function(t,n){return t.y=e-t.y-t.height+1,t}))}},{key:"getExtraLeft",value:function(){return Math.min.apply(Math,Object(v.a)(this.gridItems.map((function(e){return e.x}))))-1}},{key:"getExtraTop",value:function(){return Math.min.apply(Math,Object(v.a)(this.gridItems.map((function(e){return e.y}))))-1}},{key:"getExtraBetween",value:function(){var e=this.gridItems.slice(0,4);return 40-Math.max.apply(Math,Object(v.a)(e.map((function(e){return e.y+e.height}))))+1}}]),e}(),j=function(){function e(t,n,i,o){y(this,e),this.sizeContrast=i.sizeContrast/20,this.positionShift=i.positionShift/5,this.objectPosition=i.objectPosition,this.imageResizing=i.imageResizing,this.imageRotation=i.imageRotation,this.image=t,this.index=n,this.idx=this.getIndex(n),this.col=this.idx%2,this.row=Math.floor(n/2),o&&(0===n&&(this.positionShift=Math.min(this.positionShift,10)),2===n&&(this.positionShift=Math.max(this.positionShift,10)));var r=this.getOffsets(),a=r.offsetX,l=r.offsetY,c=20-this.sizeContrast*(n%4);this.x=20*this.col+1+a,this.y=20*this.row+1+l,this.width=c,this.height=c}return O(e,[{key:"getOffsets",value:function(){var e=this.row,t=this.col,n=this.index,i=this.sizeContrast,o=this.positionShift,r=n%4*(1-t%2)*i,a=n%4*(1-e%2)*i;return r+=(1-t%2)*(1-e%2)*o,a-=e%2*(1-t%2)*o,{offsetX:r-=t%2*(e%2)*o,offsetY:a+=t%2*(1-e%2)*o}}},{key:"getIndex",value:function(e){return e%4==3?e-1:e%4==2?e+1:e}},{key:"getStyle",value:function(){var e=this.index,t=this.x,n=this.y,i=this.width,o=this.height,r=this.imageRotation,a="rotate(".concat((e%2-.5)*r/10,"deg)");return{gridColumnStart:t+"",gridColumnEnd:"span ".concat(i),gridRowStart:n+"",gridRowEnd:"span ".concat(o),transform:a}}},{key:"getImageStyle",value:function(){var e=this.row,t=this.col,n=this.objectPosition,i=e%2==0?100-n:n;return{objectFit:"cropped"===this.imageResizing?"cover":"scale-down",objectPosition:"".concat(t%2==0?100-n:n,"% ").concat(i,"%")}}}]),e}(),w=function(){return{sizeContrast:20*Object(g.getRandomBetween)(0,5),positionShift:5*Object(g.getRandomBetween)(0,20),elementsDistance:20*Object(g.getRandomBetween)(0,5),placementVariation:25*Object(g.getRandomBetween)(1,4),stylePreset:"just-my-style"}},E=function(e){var t=e.elementsDistance;return{"--nb-media-composition-gap":"".concat(t,"px")}},x=function(e){if(g.isSafari){var t=e.parentNode,n=f()(e),i=f()(t),o=function(){var e=i.outerHeight();n.css("height",e)},r=Object(g.debounce)(o,30);if(o(),void 0!==window.ResizeObserver)new window.ResizeObserver((function(e){r()})).observe(t);else f()(window).on("resize",(function(){r()}))}},k=function(e){var t=e.attributes,n=e.setAttributes,i=e.name,o=t.containerHeight,l=t.imageResizing;return["novablocks/supernova","novablocks/supernova-item"].includes(i)?null:Object(r.createElement)(r.Fragment,null,Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-media-aspect-ratio",label:Object(a.__)("Media Aspect Ratio","nova-blocks"),value:o,onChange:function(e){return n({containerHeight:e})},min:0,max:100,step:5}),Object(r.createElement)(c.RadioControl,{key:"advanced-gallery-image-resizing",label:Object(a.__)("Image Resizing","nova-blocks"),selected:l,onChange:function(e){return n({imageResizing:e})},options:[{label:Object(a.__)("Stretch to fill the container","nova-blocks"),value:"cropped"},{label:Object(a.__)("Shrink to fit (no crop)","nova-blocks"),value:"original"}]}))},C=Object(s.withVisibility)("media-composition-section")((function(e){var t=e.clientId,n=e.setAttributes,i=e.attributes,o=Object(s.useSettings)(),l=i.sizeContrast,u=i.positionShift,d=i.elementsDistance,m=i.placementVariation,b=i.imageResizing,f=i.objectPosition,g=i.imageRotation;return Object(r.createElement)(s.ControlsSection,{id:"media-composition",label:Object(a.__)("Media Composition","nova-blocks"),group:Object(a.__)("Card Anatomy","nova-blocks"),order:15,key:t+"_media-composition-controls-section"},Object(r.createElement)(s.ControlsTab,{label:Object(a.__)("Presets","nova-blocks"),key:"media_composition_presets"},Object(r.createElement)(s.Notice,{key:"advanced-gallery-quick-start",id:"novablocks-media-composition-quick-start",content:Object(r.createElement)("p",null,Object(r.createElement)("strong",null,Object(a.__)("Quick start:","nova-blocks"))," ",Object(a.__)("Set up your gallery layout using the presets list below and use the Customize tab to fine-tune the details.","nova-blocks")),dismissLabel:Object(a.__)("✔ Ok, I got it!","nova-blocks")}),Object(r.createElement)(s.PresetControl,Object(p.a)({key:"advanced-gallery-style-preset",options:o.advancedGalleryPresetOptions,randomize:w},e))),Object(r.createElement)(s.ControlsTab,{label:Object(a.__)("Customize","nova-blocks"),key:"media_composition_customize"},Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-crop-style",label:Object(a.__)("Images Crop Style","nova-blocks"),value:"cropped"===b?2:1,onChange:function(e){n({imageResizing:2===e?"cropped":"original"})},min:1,max:2,step:1})),Object(r.createElement)(s.ControlsTab,{label:Object(a.__)("Settings","nova-blocks"),key:"media_composition_settings"},Object(r.createElement)(s.ControlsGroup,{title:Object(a.__)("Gallery","nova-blocks")},Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-size-contrast",label:Object(a.__)("Size Contrast","nova-blocks"),value:l,onChange:function(e){return n({sizeContrast:e})},min:0,max:100,step:20}),Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-position-shift",label:Object(a.__)("Position Shift","nova-blocks"),value:u,onChange:function(e){return n({positionShift:e})},min:0,max:100,step:5}),Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-elements-distance",label:Object(a.__)("Elements Distance","nova-blocks"),value:d,onChange:function(e){return n({elementsDistance:e})},min:0,max:100,step:20}),Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-placement-variation",label:Object(a.__)("Placement Variation","nova-blocks"),value:m,onChange:function(e){return n({placementVariation:e})},min:25,max:100,step:25}),Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-image-rotation",label:Object(a.__)("Image Rotation","nova-blocks"),value:g,onChange:function(e){return n({imageRotation:e})},min:0,max:100,step:10})),Object(r.createElement)(s.ControlsGroup,{title:Object(a.__)("Display","nova-blocks")},Object(r.createElement)(k,e),Object(r.createElement)(c.RangeControl,{key:"advanced-gallery-image-position",label:Object(a.__)("Image Position","nova-blocks"),value:f,onChange:function(e){return n({objectPosition:e})},min:0,max:100,step:10}))))})),S=n(50),M=Object(S.withShapeModelingDecoration)((function(e){var t,n,i=e.gridItem,o=null==i?void 0:i.image,a=(null==o||null===(t=o.sizes)||void 0===t||null===(n=t.novablocks_medium)||void 0===n?void 0:n.url)||(null==o?void 0:o.url),l=i.getImageStyle();return Object(r.createElement)(r.Fragment,null,"video"!==o.type&&Object(r.createElement)("img",{className:"novablocks-media-composition__image",src:a,alt:null==o?void 0:o.alt,style:l}),"video"===o.type&&Object(r.createElement)("video",{muted:!0,autoPlay:!0,loop:!0,playsInline:!0,className:"novablocks-media-composition__image",style:l,src:o.url}))}));function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var P=function(e){var t=e.gridItem,n=e.attributes,i=null==t?void 0:t.image,o=null==i?void 0:i.caption,a=null==i?void 0:i.description;if(i){var l=n.showDescription,c=void 0!==l&&l,s="string"==typeof o&&!!o,u="string"==typeof a&&!!a;return Object(r.createElement)("div",{className:"novablocks-media-composition__grid-item",style:t.getStyle()},Object(r.createElement)("div",{className:"novablocks-media-composition__grid-item-media"},Object(r.createElement)(M,Object(p.a)({},e,{seedOffset:null==e?void 0:e.index}))),c&&(s||u)&&Object(r.createElement)("div",{className:"novablocks-media-composition__grid-item-info"},s&&Object(r.createElement)("div",{className:"novablocks-media-composition__grid-item-caption",dangerouslySetInnerHTML:{__html:o}}),I(u)&&Object(r.createElement)("div",{className:"novablocks-media-composition__grid-item-description",dangerouslySetInnerHTML:{__html:a}})))}},R=function(e){var t=e.attributes,n=e.onSelectImages,i=null==t?void 0:t.images;return(!i||!i.length)&&Object(r.createElement)(l.MediaPlaceholder,{icon:Object(r.createElement)(l.BlockIcon,{icon:"format-gallery"}),allowedTypes:["image","video"],multiple:!0,onSelect:n})},z=n(24),T=function(e){var t=e.attributes,n=e.onSelectImages,i=(null==t?void 0:t.images)||[],o=i.map((function(e){return e.id}));if(!i||!i.length)return Object(r.createElement)(R,e);var c=Object(r.useState)(0),s=Object(z.a)(c,2),u=s[0],d=s[1],m=Object(r.useRef)(null);Object(r.useEffect)((function(){d(m.current?m.current.clientHeight:0)}));var b=new _(i,t),f=E(t);return g.isSafari&&Object.assign(f,{height:u}),Object(r.createElement)(l.MediaUpload,{gallery:!0,allowedTypes:["image","video"],multiple:!0,onSelect:n,value:o,render:function(t){var n=t.open;return Object(r.createElement)("div",{className:"novablocks-media-composition",ref:m},Object(r.createElement)("div",{className:"novablocks-media-composition__media-edit novablocks-change-media-overlay",onClick:n},Object(r.createElement)("span",null,Object(a.__)("Change Media","nova-blocks"))),Object(r.createElement)("div",{className:"novablocks-media-composition__grid",style:f},b.gridItems.map((function(t,n){return Object(r.createElement)(P,Object(p.a)({gridItem:t,key:"gallery_item_"+n,index:n},e))}))))}})},B=function(e){return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(T,e),Object(r.createElement)(m,e),Object(r.createElement)(C,e))},A=n(14);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){Object(A.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){var t,n,i=null==e||null===(t=e.supports)||void 0===t||null===(n=t.novaBlocks)||void 0===n?void 0:n.mediaComposition;return!0!==i&&!0!==(null==i?void 0:i.attributes)?e:D(D({},e),{},{attributes:D(D({},e.attributes),o)})},G=n(7),H=Object(G.createHigherOrderComponent)((function(e){return function(t){var n,i,o,a=Object(s.useSupports)(t.name);return!0!==(null==a||null===(n=a.novaBlocks)||void 0===n?void 0:n.mediaComposition)&&!0!==(null==a||null===(i=a.novaBlocks)||void 0===i||null===(o=i.mediaComposition)||void 0===o?void 0:o.controls)?Object(r.createElement)(e,t):Object(r.createElement)(r.Fragment,null,Object(r.createElement)(C,t),Object(r.createElement)(e,t))}}),"withMediaCompositionControls"),V=Object(G.createHigherOrderComponent)((function(e){return function(t){var n,i,o,a=Object(s.useSupports)(t.name);return!0!==(null==a||null===(n=a.novaBlocks)||void 0===n?void 0:n.mediaComposition)&&!0!==(null==a||null===(i=a.novaBlocks)||void 0===i||null===(o=i.mediaComposition)||void 0===o?void 0:o.blockControls)?Object(r.createElement)(e,t):Object(r.createElement)(r.Fragment,null,Object(r.createElement)(m,t),Object(r.createElement)(e,t))}}),"withMediaCompositionControls"),L=Object(G.createHigherOrderComponent)((function(e){return function(t){var n,i=Object(s.useSupports)(t.name),o=t.attributes,a=t.style?t.style:{};return null!=i&&null!==(n=i.novaBlocks)&&void 0!==n&&n.mediaComposition&&Object.assign(a,E(o)),Object(r.createElement)(e,Object(p.a)({},t,{style:a}))}}),"withMediaCompositionEditCustomProps");Object(i.addFilter)("blocks.registerBlockType","novablocks/with-media-composition-attributes",F),Object(i.addFilter)("editor.BlockEdit","novablocks/with-media-composition-controls",H),Object(i.addFilter)("editor.BlockEdit","novablocks/with-media-composition-block-controls",V),Object(i.addFilter)("editor.BlockEdit","novablocks/with-media-composition-edit-custom-props",L);t.default=B}});