this.novablocks=this.novablocks||{},this.novablocks.scrollingEffect=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=76)}({0:function(t,e){t.exports=window.wp.element},1:function(t,e){t.exports=window.wp.i18n},14:function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return o}))},17:function(t,e,n){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n.d(e,"a",(function(){return o}))},21:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(17);function r(t,e){if(t){if("string"==typeof t)return Object(o.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(o.a)(t,e):void 0}}},24:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(21);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var o,r,c=[],l=!0,i=!1;try{for(n=n.call(t);!(l=(o=n.next()).done)&&(c.push(o.value),!e||c.length!==e);l=!0);}catch(t){i=!0,r=t}finally{try{l||null==n.return||n.return()}finally{if(i)throw r}}return c}}(t,e)||Object(o.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},26:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n(17);var r=n(21);function c(t){return function(t){if(Array.isArray(t))return Object(o.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Object(r.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},3:function(t,e){t.exports=window.wp.components},34:function(t,e){t.exports=window.novablocks.easings},4:function(t,e){t.exports=window.novablocks.utils},5:function(t,e){t.exports=window.novablocks.blockEditor},6:function(t,e){t.exports=window.wp.hooks},7:function(t,e){t.exports=window.wp.compose},76:function(t,e,n){"use strict";n.r(e),n.d(e,"withScrollingEffect",(function(){return R})),n.d(e,"useScrollingEffect",(function(){return H})),n.d(e,"getIntermediateFocalPoint",(function(){return S})),n.d(e,"getStyles",(function(){return w})),n.d(e,"getStylesFromProps",(function(){return E})),n.d(e,"getProps",(function(){return _})),n.d(e,"getState",(function(){return k})),n.d(e,"getFocalPointImage",(function(){return C}));var o=n(6),r=n(14);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var i,a,u={scrollingEffect:{type:"string",default:"static"},focalPoint:{type:"object",default:{x:.5,y:.5}},finalFocalPoint:{type:"object",default:{x:.5,y:.5}},initialBackgroundScale:{type:"number",default:1},finalBackgroundScale:{type:"number",default:1},motionPreset:{type:"string",default:"standard-dynamic"},followThroughStart:{type:"boolean",default:!0},followThroughEnd:{type:"boolean",default:!0}},s=function(t){var e,n,o=null==t||null===(e=t.supports)||void 0===e||null===(n=e.novaBlocks)||void 0===n?void 0:n.scrollingEffect;return!0===o||null!=o&&o.attributes?l(l({},t),{},{attributes:l(l({},t.attributes),u)}):t},f=n(0),b=n(7),p=n(5),d=n(26),g=n(1),m=n(3),h=function(t){var e,n,o,r=t.setAttributes,c=t.attributes,l=c.scrollingEffect,i=c.motionPreset,a=t.name,u=Object(p.useSettings)(),s=Object(p.useSupports)(a),b=u.motionPresetOptions,h=Object(d.a)(u.scrollingEffectOptions);return!0!==(null==s||null===(e=s.novaBlocks)||void 0===e?void 0:e.scrollingEffect)&&!0!==(null==s||null===(n=s.novaBlocks)||void 0===n||null===(o=n.scrollingEffect)||void 0===o?void 0:o.doppler)||h.push({label:Object(g.__)("Doppler by Pixelgrade Â®","nova-blocks"),value:"doppler"}),Object(f.createElement)(p.ControlsSection,{id:"scrolling-effect",label:Object(g.__)("Scrolling Effect","nova-blocks"),group:Object(g.__)("Modules","nova-blocks"),order:20},Object(f.createElement)(p.ControlsTab,{label:Object(g.__)("Customize","nova-blocks")},Object(f.createElement)(m.RadioControl,{key:"novablocks-scrolling-effect",selected:l,className:"novablocks-scrolling-effect",onChange:function(t){var e={scrollingEffect:t};if("doppler"===t&&"custom"!==i){var n=b.find((function(t){return i===t.value}));(e=Object.assign(n.preset,e)).minHeightFallback=75}r(e)},options:h}),t.children))},O=n(34),v=n(4),j=function(t){var e=t.clientId,n=Object(p.useScrollContainer)(),o=Object(f.useCallback)((function(){var t=document.querySelector("#block-".concat(e));if(t&&n){var o=t.getBoundingClientRect(),r=n.getBoundingClientRect(),c=n.scrollTop+o.top-r.top-n.offsetHeight,l=c+n.offsetHeight+t.offsetHeight;Object(v.scrollFromTo)(n,c,l,2e3,O.easeInOutCubic)}}),[n]);return Object(f.createElement)("div",{className:"nb-scrolling-preview-control"},Object(f.createElement)(m.Button,{islarge:"true",isPrimary:!0,disabled:!1,onClick:o},Object(g.__)("Preview Scrolling","nova-blocks")))},y=function(t){var e=t.attributes,n=e.motionPreset,o=e.scrollingEffect,r=t.setAttributes;if("doppler"!==o)return null;var c=Object(p.useSettings)();return Object(f.createElement)(m.PanelBody,{title:"Doppler Scrolling Settings"},Object(f.createElement)(m.RadioControl,{label:"Motion Presets",selected:n,onChange:function(t){var e={motionPreset:t},n=c.motionPresetOptions.find((function(e){return t===e.value}));n&&n.preset&&(e=Object.assign(n.preset,e)),r(e)},options:c.motionPresetOptions}))},x=(i=window.matchMedia("(prefers-reduced-motion: reduce)"),a=!1,i.addEventListener("change",(function(t){a=!!t.matches})),function(){return a}),S=function(t,e,n){return t||e?t?e?{x:parseFloat(t.x)+(parseFloat(e.x)-parseFloat(t.x))*n,y:parseFloat(t.y)+(parseFloat(e.y)-parseFloat(t.y))*n}:t:e:{x:.5,y:.5}},w=function(t,e){if("static"===e.scrollingEffect)return{};var n=_(t,e);return E(n)},E=function(t){var e=t.fixed,n=t.parallaxAmount,o=t.width,r=t.height,c=t.moveX,l=t.moveY,i=t.offsetX,a=t.offsetY,u=t.scale,s=t.focalPoint;return{position:e?"fixed":"absolute",top:0,left:0,width:o?"".concat(o,"px"):"",height:r?"".concat(r,"px"):"",minHeight:0,maxWidth:"none",transform:"translate(".concat(c,",").concat(l*n,"px) translateX(").concat(i,") translateY(").concat(a,"px) scale(").concat(u,")"),objectPosition:100*s.x+"% "+100*s.y+"%",transformOrigin:100*s.x+"% 50%"}};function P(t,e,n){return t+(e-t)*n}var _=function(t,e,n){var o=t.distance,r=t.progress,c=t.containerBox,l=t.scrollContainerBox,i=t.smoothStart,a=t.smoothEnd,u=e.scrollingEffect,s=function(t,e){var n=t.scrollingEffect,o=t.focalPoint,r=t.finalFocalPoint;return o||(o={x:.5,y:.5}),"doppler"!==n?o:S(o,r,e)}(e,r),f=x()?0:"parallax"===u?.75:1,b=function(t,e){var n=t.scrollingEffect,o=t.initialBackgroundScale,r=t.finalBackgroundScale;o=o||1,"parallax"===n&&(r=o);var c=Math.max(o,r);return o/=c,r/=c,x()?{maxScale:1,newScale:1}:{maxScale:c,newScale:P(o,r,e)}}(e,r),p=b.maxScale,d=b.newScale,g=function(t,e){var n=t.scrollContainerBox,o=t.containerBox;return o.height+(n.height-o.height)*e}(t,f),m=l.top-c.top;i||(n&&c.top<0&&(m=l.top),!n&&0>l.top-c.top&&(m=0)),a||l.top-c.top>c.height-l.height&&(m=n?l.top-c.top-c.height+l.height:c.height-l.height);var h=g*p*(d-1)*.5;return h+=g*(1-p*d)*s.y,{fixed:n,distance:o,parallaxAmount:n?1-f:f,progress:r,width:c.width*p,height:g*p,moveX:"".concat(n?c.left-l.left:0,"px"),moveY:n?-1*m:m,offsetX:(1/p-1)*s.x*100+"%",offsetY:h,scale:d,focalPoint:s}},k=function(t,e){var n=t.containerBox,o=t.scrollContainerBox,r=e.scrollingEffect,c=e.followThroughStart||"parallax"===r,l=e.followThroughEnd||"parallax"===r,i=o.top-n.top,a=n.height-o.height;c&&(i+=o.height,a+=o.height),l&&(a+=o.height);var u=a<=0?.5:i/a;return c||(u=Math.max(0,u)),l||(u=Math.min(1,u)),x()&&(u=.5),{progress:u,distance:a,smoothStart:c,smoothEnd:l,containerBox:n,scrollContainerBox:o}},C=function(t){var e,n,o,r,c=null==t?void 0:t.type,l=!1;"image"===c&&(l={url:(null==t||null===(e=t.sizes)||void 0===e||null===(n=e.novablocks_large)||void 0===n?void 0:n.url)||(null==t||null===(o=t.sizes)||void 0===o||null===(r=o.novablocks_huge)||void 0===r?void 0:r.url)||(null==t?void 0:t.url),width:218,height:170});return"video"===c&&(l={url:"//cloud.pixelgrade.com/wp-content/uploads/2020/01/Screenshot-2020-01-09-at-15.59.37.png",width:218,height:170}),l},B=Object(p.withVisibility)("start-frame-panel")((function(t){var e=t.attributes,n=t.setAttributes,o=t.focalPointImage,r=e.media,c=e.focalPoint,l=e.finalFocalPoint,i=e.initialBackgroundScale,a=e.followThroughStart,u=e.scrollingEffect,s=Object(f.useMemo)((function(){return o||C(r)}),[o,r]),b="doppler"===u,p=Object(g.__)("Static Scrolling Settings","nova-blocks"),d=Object(g.__)("Parallax Scrolling Settings","nova-blocks"),h=Object(g.__)("Start Frame","nova-blocks"),O=p;"parallax"===u&&(O=d),b&&(O=h);var j=["novablocks-focal-point-picker","novablocks-focal-point-picker--".concat(u),"novablocks-focal-point-picker--start",Object(v.getSnapClassname)(c)].join(" ");return Object(f.createElement)(m.PanelBody,{title:O,className:j},Object(f.createElement)(m.FocalPointPicker,{label:"Focal Point",url:s.url,dimensions:{width:s.width,height:s.height},value:c,onChange:function(t){n({motionPreset:"custom",focalPoint:Object(v.maybeSnapFocalPoint)(t),finalFocalPoint:Object(v.maybeSnapFocalPoint)({x:t.x,y:l.y})})}}),Object(f.createElement)(m.RangeControl,{label:"Zoom",value:i,onChange:function(t){n({motionPreset:"custom",initialBackgroundScale:t})},min:1,max:2,step:.01}),"doppler"===u&&Object(f.createElement)(m.ToggleControl,{label:Object(g.__)("Smooth start transition","nova-blocks"),checked:a,onChange:function(){n({followThroughStart:!a})}}))})),F=function(t){var e=t.attributes,n=t.setAttributes,o=t.focalPointImage,r=e.media,c=e.focalPoint,l=e.finalFocalPoint,i=e.finalBackgroundScale,a=e.followThroughEnd,u=e.scrollingEffect,s=Object(f.useMemo)((function(){return o||C(r)}),[o,r]);if("doppler"!==u)return null;var b=["novablocks-focal-point-picker","novablocks-focal-point-picker--".concat(u),"novablocks-focal-point-picker--end",Object(v.getSnapClassname)(c)].join(" ");return Object(f.createElement)(m.PanelBody,{title:Object(g.__)("End Frame","nova-blocks"),className:b},Object(f.createElement)(m.FocalPointPicker,{label:"Focal Point",url:s.url,dimensions:{width:s.width,height:s.height},value:l,onChange:function(t){n({motionPreset:"custom",focalPoint:Object(v.maybeSnapFocalPoint)({x:t.x,y:c.y}),finalFocalPoint:Object(v.maybeSnapFocalPoint)(t)})},disabled:!0}),Object(f.createElement)(m.RangeControl,{label:"Zoom",value:i,onChange:function(t){n({motionPreset:"custom",finalBackgroundScale:t})},min:1,max:2,step:.01}),Object(f.createElement)(m.ToggleControl,{label:Object(g.__)("Smooth end transition","nova-blocks"),checked:a,onChange:function(){return n({motionPreset:"custom",followThroughEnd:!a})}}))},T=Object(p.withVisibility)("scrolling-effect-section")((function(t){return Object(f.createElement)(h,t,Object(f.createElement)(j,t),Object(f.createElement)(y,t),Object(f.createElement)(B,t),Object(f.createElement)(F,t))})),A=Object(b.createHigherOrderComponent)((function(t){return function(e){var n,o=Object(p.useSupports)(e.name),r=null==o||null===(n=o.novaBlocks)||void 0===n?void 0:n.scrollingEffect;return!0===r||null!=r&&r.controls?Object(f.createElement)(f.Fragment,null,Object(f.createElement)(T,e),Object(f.createElement)(t,e)):Object(f.createElement)(t,e)}}),"withDopplerControls"),M=n(24),I=Object(f.createContext)(),R=Object(b.createHigherOrderComponent)((function(t){return function(e){var n=Object(f.useRef)(null),o=Object(f.useState)({}),r=Object(M.a)(o,2),c=r[0],l=r[1],i=e.attributes,a=Object(p.useScrollContainer)(),u=Object(p.useScrollContainerBox)(a),s=Object(p.useResizeObserver)(),b=Object(M.a)(s,2),d=b[0],g=b[1],m=Object(f.useState)(null),h=Object(M.a)(m,2),O=h[0],v=h[1],j=Object(f.useCallback)((function(){n.current&&v(n.current.getBoundingClientRect())}),[n]);return Object(p.useOnScroll)(a,j),Object(f.useEffect)((function(){n.current&&d(n.current)}),[n]),Object(f.useEffect)((function(){v(g.contentRect)}),[g]),Object(f.useEffect)((function(){if(O&&u){var t={scrollContainerBox:u,containerBox:O},e=k(t,i),o=Object.assign({},t,e),r={style:w(o,i),state:e,container:n.current,scrollContainer:a};l(r)}}),[O,u,i,n,a]),Object(f.createElement)("div",{className:"novablocks-doppler__mask novablocks-doppler__wrapper",ref:n},Object(f.createElement)(I.Provider,{value:c},Object(f.createElement)(t,e)))}}),"withDopplerProvider"),D=Object(b.createHigherOrderComponent)((function(t){return function(e){var n,o,r=Object(p.useSupports)(e.name),c=R(t);return null==r||null===(n=r.novaBlocks)||void 0===n||!n.scrollingEffect||null!=r&&null!==(o=r.novaBlocks)&&void 0!==o&&o.scrollingEffect.customWrapper?Object(f.createElement)(t,e):Object(f.createElement)(c,e)}}),"withScrollingEffectWrapper"),H=function(){return Object(f.useContext)(I)};Object(o.addFilter)("blocks.registerBlockType","novablocks/with-scrolling-effect-attributes",s),Object(o.addFilter)("editor.BlockEdit","novablocks/with-scrolling-effect-controls",A),Object(o.addFilter)("editor.BlockEdit","novablocks/with-scrolling-effect-wrapper",D,1)}});